# AI 生成內容 UI/UX 優化日誌

**負責人:** Senior Frontend Engineer

---

## 1.0 版本 - AI 內容呈現優化

**日期:** 2024-09-24

### 1.1 優化目標

此版本優化的核心目標是提升平台中由 AI (Gemini API) 生成分析內容的可讀性、結構化程度與互動性。原先的實現普遍以純文字段落形式呈現 AI 回應，導致資訊層次不清、關鍵洞察難以凸顯，且使用者無法直接基於建議採取行動，造成了「洞察」與「操作」之間的斷層。

我們期望將 AI 的輸出從「靜態報告」轉化為「動態、可操作的智慧化工作流程」，讓使用者能更直觀地理解分析結果，並一鍵觸及後續處理環節。

### 1.2 整體技術策略

為實現上述目標，我們採用了以下統一的技術策略：

1.  **API 請求升級**：修改所有對 Gemini API (`gemini-2.5-flash`) 的請求，利用其強大的 JSON 模式能力。我們為每一種 AI 分析場景定義了明確的 `responseSchema`，強制 API 回傳結構化的 JSON 物件，而非純文字。
2.  **前端元件重構**：全面重構負責展示 AI 內容的前端元件 (`SREWarRoomPage.tsx`, `AIInsightsPage.tsx`, `IncidentAnalysisModal.tsx`)。新的元件能夠解析結構化的 JSON 回應，並將其渲染成具備清晰視覺層次的卡片、列表和互動元素。
3.  **增加互動性與行動導向**：在新的 UI 中，我們根據 API 回傳的結構化資料（如 `resource_path`, `action_link`, `playbook_id`），動態生成可點擊的連結和行動號召（Call-to-Action）按鈕，將使用者直接引導至相關的資源頁面或自動化腳本。

### 1.3 各功能區塊優化詳情

#### 1.3.1 SRE 戰情室 - AI 每日簡報

-   **改造前**：顯示為一大段純文字，混合了系統穩定性、異常現象和建議。
-   **改造後**：將單一文字塊拆解為三個獨立的、語意明確的卡片：「穩定性摘要」、「關鍵異常」和「建議操作」。異常中提及的資源名稱現在是可點擊的 `Link`，建議操作也提供了直接的行動號召按鈕。
-   **API 變更**：`SREWarRoomPage.tsx` 中的 `generateBriefing` 函式新增了 `responseSchema`，要求 API 回傳結構化的 JSON 物件。

#### 1.3.2 AI 洞察 - 主動優化建議

-   **改造前**：建議以純文字列表呈現，使用者需手動尋找相關功能。
-   **改造後**：在建議卡片中動態生成**可選的操作按鈕**（如「查看資源」），實現從「洞察」到「行動」的無縫銜接。
-   **API 變更**：`AIInsightsPage.tsx` 中的 `generateSuggestions` 函式更新了 `responseSchema`，增加了可選的 `action_button_text` 和 `action_link` 欄位。

#### 1.3.3 事件列表 - AI 分析報告

-   **改造前**：無論單一或多事件分析，都只顯示純文字結果。
-   **改造後**：報告內容被徹底重構，劃分為「摘要」、「根本原因/共同模式」、「建議步驟」等清晰區塊。每一條建議都封裝在獨立的卡片中，並附帶可直接觸發的**操作按鈕**。
-   **API 變更**：`IncidentListPage.tsx` 中的 `handleAiButtonClick` 函式針對單一和多事件分析，分別定義了不同的 `responseSchema`，`IncidentAnalysisModal.tsx` 能夠智能渲染兩種報告。

---

## 2.0 版本 - 智慧化工作流程整合與互動體驗升級

**日期:** 2024-09-25

### 2.1 規劃目標

在 1.0 版本成功優化 AI **結果呈現**的基礎上，2.0 版本旨在將 AI 更深層次地整合到 SRE 的核心工作流程中，並全面提升平台的互動效率與客製化能力。目標是將平台從一個「高效的監控工具」升級為一個具備預測和引導能力的「**智慧化營運中樞**」。

### 2.2 擴展 AI 整合至核心工作流程

#### 2.2.1 AI 驅動的日誌分析 (`LogExplorerPage.tsx`)

-   **現狀**：日誌瀏覽器僅提供基本的關鍵字搜尋和時間篩選。
-   **優化規劃**：
    1.  **AI 日誌總結**：新增「AI 總結日誌」按鈕。點擊後，AI 會分析當前篩選出的日誌，並以自然語言總結出主要模式、錯誤分佈、異常關聯和潛在的根本原因。
    2.  **AI 異常日誌模式偵測**：AI 主動在日誌流中標示出不尋常的模式（例如，某個錯誤日誌的出現頻率突然增加，或是在特定服務部署後出現了新的錯誤類型），即使這些模式未被現有規則覆蓋。

#### 2.2.2 AI 鏈路追蹤解析 (`TraceAnalysisPage.tsx`)

-   **現狀**：提供鏈路追蹤的可視化時間軸，但需要工程師手動解讀。
-   **優化規劃**：
    1.  **AI 瓶頸分析**：在選擇一條 Trace 後，增加「AI 分析瓶頸」功能。AI 將自動識別出鏈路中的關鍵路徑、耗時最長的 Span，並以自然語言解釋潛在的效能瓶頸（例如，「`payment-service` 的 `processPayment` 佔用了 85% 的總時間，主要瓶頸在於對 `payment-db` 的一次慢查詢」）。

#### 2.2.3 自然語言生成自動化腳本 (`AutomationPlaybooksPage.tsx`) - ✅ **已實現**

-   **現狀**：工程師需要手動編寫 Shell 或 Python 腳本。
-   **優化實現**：
    1.  **AI 輔助生成腳本**：在新增/編輯腳本時，提供一個「由 AI 生成」的選項。使用者可以用自然語言描述他們想完成的任務（例如，「寫一個 Shell 腳本，檢查 'production' 命名空間下所有 pod 的重啟次數，並列出重啟超過 5 次的 pod」），AI 將生成腳本草稿，供使用者預覽和修改。

### 2.3 提升互動與操作流暢度

#### 2.3.1 命令面板 (Command Palette) 升級 (`AppLayout.tsx`)

-   **現狀**：`Ctrl+K` 僅為一個簡單的頁面搜尋框。
-   **優化規劃**：
    1.  將其升級為一個全功能的**命令面板**。除了搜尋頁面外，使用者還可以輸入命令來執行快速操作，例如：
        -   `> new incident`：直接開啟建立事件的表單。
        -   `> silence api-gateway-prod-01 for 2 hours`：快速建立靜音規則。
        -   `> run playbook: restart pod`：搜尋並執行指定的自動化腳本。

#### 2.3.2 資源拓撲圖的上下文操作 (`ResourceTopologyPage.tsx`)

-   **現狀**：拓撲圖主要用於視覺化展示，缺乏直接的互動操作。
-   **優化規劃**：
    1.  在拓撲圖的節點上增加**右鍵上下文選單**，提供針對該資源的快捷操作，例如：
        -   查看資源詳情
        -   檢視相關事件
        -   執行自動化腳本...
        -   SSH 至節點

### 2.4 數據可視化與客製化升級

#### 2.4.1 拖拽式儀表板編輯器 (`DashboardEditorPage.tsx`)

-   **現狀**：新增儀表板時，只能從列表中選擇小工具進行添加，佈局固定。
-   **優化規劃**：
    1.  引入**響應式、可拖拽的網格佈局系統**（例如使用 `react-grid-layout`）。使用者可以自由拖動小工具來調整其位置和大小，實現高度客製化的儀表板佈局，並將其保存為個人或團隊範本。

---

## 3.0 版本 - 規劃中：邁向 AIOps 閉環與全域優化

### 3.1 規劃目標

在 2.0 版本實現深度工作流程整合的基礎上，3.0 版本旨在打破各模組之間的數據孤島，實現 AIOps 的閉環操作，將平台從「智慧輔助」進化為具備初步「自主營運」能力的系統。

### 3.2 核心功能藍圖

#### 3.2.1 AIOps 閉環自動化

-   **目標**：實現從「AI 建議」到「AI 執行」的閉環。
-   **功能**：在 AI 分析報告的建議操作中，增加「授權執行」按鈕。對於高信賴度的建議（例如，重啟一個已知的故障 Pod），平台將允許使用者一鍵授權 AI 調度對應的自動化腳本完成修復，並將執行結果回寫到事件時間軸中。

#### 3.2.2 跨域關聯分析

-   **目標**：整合日誌、指標、追蹤（Metrics, Logs, Traces）三類數據，提供更深度的根因分析。
-   **功能**：當一個事件發生時，AI 不僅分析該事件的指標，還會自動拉取事件發生時間點前後相關資源的日誌和鏈路追蹤數據。透過跨域分析，找出傳統監控難以發現的複雜問題模式（例如，一個 Trace 中的延遲增加與某個服務的錯誤日誌數量正相關）。

#### 3.2.3 預測性容量規劃

-   **目標**：從「被動擴容」轉向「預測性擴容」。
-   **功能**：AI 模型將基於歷史資源使用趨勢和業務增長數據（如用戶量），預測未來（例如，未來 30 天）的資源需求。當預測到容量瓶頸時，會主動建立一個「容量規劃事件」，並建議具體的擴容方案和成本預估。

#### 3.2.4 個人化與角色感知的 AI 洞察

-   **目標**：為不同角色的使用者提供最相關的 AI 洞察。
-   **功能**：AI 洞察頁面將根據登入者的角色（SRE、開發者、管理者）和最近的活動，動態調整顯示內容的優先級。例如，向開發者優先展示與其負責服務相關的效能瓶頸，而向管理者展示整體的 SLA 健康度和成本優化建議。
