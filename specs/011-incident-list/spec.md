# Feature Specification: Incident List

**Created**: 2025-10-08
**Status**: Ready for Technical Review
**Based on**: `.specify/memory/constitution.md` (v1.3.0)

---

## 一、主要使用者情境（User Scenarios & Testing）

### Primary User Story

作為一名 SRE 或平台維運人員，我需要一個集中化的事件管理介面，讓我能夠：
1.  **事件總覽** — 在單一視圖中查看所有系統事件，按嚴重性、狀態、時間快速排序與篩選。
2.  **生命週期管理** — 高效地處理事件，包括認領、指派、解決、靜音等核心操作。
3.  **協作溝通** — 在事件中添加備註、指派給其他成員，確保處理過程透明可追溯。

以便快速響應系統異常，縮短故障恢復時間（MTTR），並將事件處理經驗沉澱為團隊知識。

### 具體情境（Specific Scenarios）
- **事件總覽與優先級排序**: 每日晨會時，快速了解當前系統的整體事件狀態，確定今日工作重點。
- **生命週期管理**: 當一個嚴重事件被觸發時，能夠全程追蹤其從「新增」到「已認領」再到「已解決」的完整過程。
- **批次操作**: 當一次網路抖動導致大量相關事件產生時，能夠一鍵批次解決所有已恢復的事件。
- **協作與通知**: 當一個複雜事件需要跨團隊處理時，能夠將事件指派給特定成員，並在時間軸中記錄所有溝通與操作。

### 現有痛點（Pain Points）
- **事件分散**: 事件資訊散落在多個監控系統，缺乏統一視圖，難以掌握全局。
- **批次操作不便**: 處理大量相似事件時需逐一操作，效率低下。
- **處理歷程不透明**: 狀態變更後，無法追溯完整的處理歷史（誰在何時做了什麼）。
- **根因分析困難**: 多個事件併發時，難以憑人工快速識別事件間的關聯與根本原因。

### Acceptance Scenarios

### 場景群組 A：事件列表展示與過濾 (4 個)
1.  **Given** 我進入事件列表頁面, **When** 頁面載入完成, **Then** 系統必須按嚴重性（從高到低）和觸發時間（從新到舊）預設排序。
2.  **Given** 我想查看所有未解決的嚴重事件, **When** 我使用篩選器設定「嚴重性=Critical」和「狀態≠Resolved」, **Then** 列表應僅顯示符合條件的事件。
3.  **Given** 我在搜尋框中輸入「database」, **When** 查詢執行, **Then** 列表應僅顯示標題或標籤中包含「database」的事件。
4.  **Given** 我想自訂表格顯示的欄位, **When** 我點擊「欄位設定」並勾選「持續時長」欄位, **Then** 表格中應新增一列顯示每個事件的持續時長。

### 場景群組 B：事件生命週期管理 (4 個)
5.  **Given** 一個新事件（狀態為 New）, **When** 我點擊「認領」按鈕, **Then** 該事件的狀態應變為「Acknowledged」，且「指派人員」欄位應更新為我的名字。
6.  **Given** 一個我已認領的事件, **When** 我點擊「指派」並選擇另一位團隊成員, **Then** 「指派人員」欄位應更新為該成員的名字，且對方應收到通知。
7.  **Given** 一個已認領的事件問題已解決, **When** 我點擊「解決」按鈕, **Then** 該事件的狀態應變為「Resolved」，並從預設視圖中消失。
8.  **Given** 我在事件詳情頁的時間軸中, **When** 我輸入備註並提交, **Then** 我的備註應立即出現在時間軸頂部，並包含我的名字和時間戳。

### 場景群組 C：批次操作 (3 個)
9.  **Given** 我在事件列表中勾選了 5 個狀態為「New」的事件, **When** 我點擊批次操作欄中的「認領」, **Then** 這 5 個事件的狀態都應變為「Acknowledged」，且指派人員都應是我。
10. **Given** 我勾選了 10 個已解決的網路抖動相關事件, **When** 我點擊批次操作欄中的「靜音」，並設定靜音 1 小時, **Then** 系統應建立一個靜音規則，在接下來的 1 小時內抑制所有與這些事件相關的新告警。
11. **Given** 我想將多個事件匯出進行線下分析, **When** 我勾選 3 個事件並點擊「匯出為 CSV」, **Then** 系統應下載一個包含這 3 個事件詳細資訊的 CSV 檔案。

### 場景群組 D：整合情境 (4 個)
12. **Given** 我正在查看一個事件的詳情, **When** 我點擊「關聯事件」並搜尋另一個事件 ID, **Then** 我可以將兩個事件關聯起來，並在詳情頁中看到彼此的連結。
13. **Given** 一個事件由一個告警規則觸發, **When** 我查看事件詳情, **Then** 我應該能看到觸發此事件的具體告警規則名稱，並能點擊跳轉至該規則的設定頁面。
14. **Given** AI 分析功能已啟用, **When** 我點擊一個事件的「AI 分析」按鈕, **Then** 系統應彈出一個視窗，顯示對該事件的根因推測、影響範圍分析和建議解決方案。
15. **Given** 我儲存了一個常用的篩選條件組合為「我的待辦」, **When** 我下次進入頁面時點擊「我的待辦」快速篩選按鈕, **Then** 系統應立即套用我之前儲存的篩選條件。

---

## 二、功能需求（Functional Requirements）

### 2.1. 列表展示 (List Display)
|------|------|
- **FR-XXX**: 系統必須（MUST）提供一個可分頁、可排序的事件列表。
- **FR-XXX**: 列表必須（MUST）預設按嚴重性降序、觸發時間降序進行排序。
- **FR-XXX**: 系統必須（MUST）支援使用者自訂顯示的表格欄位。

### 2.2. 生命週期管理 (Lifecycle Management)
|------|------|
- **FR-XXX**: 系統必須（MUST）支援事件的四種核心狀態：New, Acknowledged, Resolved, Silenced。
- **FR-XXX**: 系統必須（MUST）提供認領（Acknowledge）、指派（Assign）、解決（Resolve）、靜音（Silence）操作。
- **FR-XXX**: 系統必須（MUST）在事件詳情中提供一個時間軸（Timeline），記錄所有狀態變更和操作歷史。

### 2.3. 批次操作 (Batch Operations)
|------|------|
- **FR-XXX**: 系統必須（MUST）支援對多個選中事件進行批次認領。
- **FR-XXX**: 系統必須（MUST）支援對多個選中事件進行批次解決。
- **FR-XXX**: 系統必須（MUST）支援對多個選中事件進行批次靜音。

### 2.4. 篩選與搜尋 (Filtering & Search)
|------|------|
- **FR-XXX**: 系統必須（MUST）支援按嚴重性、狀態、指派人員、觸發時間範圍進行篩選。
- **FR-XXX**: 系統必須（MUST）支援按事件標題或標籤進行關鍵字搜尋。
- **FR-XXX**: 系統應該（SHOULD）支援使用者儲存常用的篩選條件組合。

### 2.5. 整合 (Integration)
|------|------|
- **FR-XXX**: 系統必須（MUST）能夠顯示觸發事件的來源告警規則。
- **FR-XXX**: 系統應該（SHOULD）支援手動關聯多個相關事件。
- **FR-XXX**: 系統應該（SHOULD）整合 AI 分析能力，提供根因推測和解決方案建議。

---

## 四、權限控制 (RBAC)

|-----------|------|
-`incident:read` : 允許查看事件列表與詳情。 
-`incident:write` : 允許執行認領、指派、解決、靜音等操作。 
-`incident:comment` : 允許在事件上添加備註。 
-`incident:admin` : 允許刪除事件或修改他人備註。 

---

## 五、觀測性與治理（Observability & Governance）

-項目 | 狀態 : 說明 
-Logging/Tracing | ✅ : 所有事件操作均需產生審計日誌。 
-Metrics & Alerts | ✅ : 追蹤事件處理時長（MTTA, MTTR）、事件數量等關鍵指標。 
-RBAC | ✅ : 所有操作均需進行權限檢查。 
-i18n | ✅ : 所有 UI 文字均需使用 i18n Key。 
-Theme Token | ✅ : 所有顏色、狀態標籤均需使用語義化的 Theme Token。 
## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者可以在 10 秒內載入事件列表並開始處理
- **SC-002**: 支援同時處理 1000 個活躍事件，平均回應時間低於 500 毫秒
- **SC-003**: MTTA (平均確認時間) 低於 5 分鐘，MTTR (平均修復時間) 低於 30 分鐘

---
